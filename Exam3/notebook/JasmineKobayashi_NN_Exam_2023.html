<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jasmine Kobayashi">

<title>CSCI 5922: Neural Networks Exam3 (Final Exam) - Fall 2023</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="JasmineKobayashi_NN_Exam_2023_files/libs/clipboard/clipboard.min.js"></script>
<script src="JasmineKobayashi_NN_Exam_2023_files/libs/quarto-html/quarto.js"></script>
<script src="JasmineKobayashi_NN_Exam_2023_files/libs/quarto-html/popper.min.js"></script>
<script src="JasmineKobayashi_NN_Exam_2023_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="JasmineKobayashi_NN_Exam_2023_files/libs/quarto-html/anchor.min.js"></script>
<link href="JasmineKobayashi_NN_Exam_2023_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="JasmineKobayashi_NN_Exam_2023_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="JasmineKobayashi_NN_Exam_2023_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="JasmineKobayashi_NN_Exam_2023_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="JasmineKobayashi_NN_Exam_2023_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#part-3-applying-neural-nets-ann-cnn-lstm-to-real-labeled-text-data" id="toc-part-3-applying-neural-nets-ann-cnn-lstm-to-real-labeled-text-data" class="nav-link active" data-scroll-target="#part-3-applying-neural-nets-ann-cnn-lstm-to-real-labeled-text-data">Part 3: Applying Neural Nets (ANN, CNN, LSTM) to real labeled text data</a>
  <ul class="collapse">
  <li><a href="#the-overall-goals-here-include" id="toc-the-overall-goals-here-include" class="nav-link" data-scroll-target="#the-overall-goals-here-include">The overall goals here include:</a></li>
  <li><a href="#specific-requirements" id="toc-specific-requirements" class="nav-link" data-scroll-target="#specific-requirements">Specific requirements:</a></li>
  </ul></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a>
  <ul class="collapse">
  <li><a href="#separate-features-targets" id="toc-separate-features-targets" class="nav-link" data-scroll-target="#separate-features-targets">Separate Features &amp; Targets</a></li>
  <li><a href="#one-hot-encoder-to-labels" id="toc-one-hot-encoder-to-labels" class="nav-link" data-scroll-target="#one-hot-encoder-to-labels">One Hot Encoder to Labels</a></li>
  <li><a href="#training-testing-sets" id="toc-training-testing-sets" class="nav-link" data-scroll-target="#training-testing-sets">Training &amp; Testing Sets</a></li>
  </ul></li>
  <li><a href="#models" id="toc-models" class="nav-link" data-scroll-target="#models">Models</a></li>
  <li><a href="#ann" id="toc-ann" class="nav-link" data-scroll-target="#ann">ANN</a></li>
  <li><a href="#cnn" id="toc-cnn" class="nav-link" data-scroll-target="#cnn">CNN</a></li>
  <li><a href="#lstm" id="toc-lstm" class="nav-link" data-scroll-target="#lstm">LSTM</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">CSCI 5922: Neural Networks Exam3 (Final Exam) - Fall 2023</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jasmine Kobayashi </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="part-3-applying-neural-nets-ann-cnn-lstm-to-real-labeled-text-data" class="level1">
<h1>Part 3: Applying Neural Nets (ANN, CNN, LSTM) to real labeled text data</h1>
<p>For this part of the Exam, I have gathered articles on three topics: <em>football</em>, <em>science</em>, and <em>politics</em>. The data has already been cleaned, tokenized, and vectorized. Each row (vector) in the dataset is an article, each row is labeled as <em>football</em>, <em>science</em>, and <em>politics</em>. Each column is a word in the vocabulary. The data itself represents the number of times each word appear in that given article. (The data was gathered from <a href="https://newsapi.org/">newsapi.org</a>).</p>
<p><strong>Here is a link to the cleaned, prepared, labeled data.</strong></p>
<p><a href="https://drive.google.com/file/d/1-ZAbxWN29iCo44kaLSfYmV2E8YDKcgGE/view?usp=sharing" class="uri">https://drive.google.com/file/d/1-ZAbxWN29iCo44kaLSfYmV2E8YDKcgGE/view?usp=sharing</a></p>
<p>(If you want to know how this was done (<strong>not required</strong>) - here is code and a tutorial)</p>
<p><a href="https://gatesboltonanalytics.com/?page_id=254" class="uri">https://gatesboltonanalytics.com/?page_id=254</a></p>
<hr>
<section id="the-overall-goals-here-include" class="level2">
<h2 class="anchored" data-anchor-id="the-overall-goals-here-include">The overall goals here include:</h2>
<ol type="1">
<li>Coding, comparing, and using an ANN, CNN, and LSTM RNN in TF/Keras (Python) to Train models and to Test their accuracy.</li>
<li>You want to see if you can predict the topic of an article (in this case - <em>football</em>, <em>science</em>, and <em>politics</em>).</li>
<li>You also want to compare and illustrate the accuracy of your models and determine/discuss which model (ANN, CNN, or LSTM) is best and why this might be.</li>
<li><strong>It is up to you how to do this and how best to illustrate and explain your steps, results, and conclusions. Assume the reader is non-technical.</strong></li>
<li>You will include a <strong>link</strong> to your code, but do not paste or otherwise include code on the Exam document. (Again, you can place your code wherever you want as long as there is a link to it).</li>
</ol>
</section>
<section id="specific-requirements" class="level2">
<h2 class="anchored" data-anchor-id="specific-requirements">Specific requirements:</h2>
<p>There are many ways to do this. The following offeres a few core requirements. Beyond this, <strong>YOU must decide what to do and how best to do it.</strong> Part of your grade will be based on your flow, discussion, illustrations, report, and communication of methods and results. Again, you will post a link to the code, but you will not include or paste code in the word doc.</p>
<ol type="1">
<li><p>Use Python and TF/Keras to Train and then Test the accuracy for an ANN, CNN, and LSTM RNN. In other words, you will use three different Neural Networks to create models that should predict whether a test vector (which represents an article on a topic) is on the topic of <em>science</em>, <em>football</em>, or <em>politics</em>. You will need to write code to do this. You already have code for ANNs, CNNs, and LSTM RNNs, so you may choose to repurpose/update your code as needed.</p></li>
<li><p>To show your work and to <strong>illustrate and explain</strong> your work, results, and conclusions you must include at least the following:</p>
<ol type="a">
<li><p>A link to your code. If you wish, you can put your code on your website, Google Colab, GitHub or wherever, an the include the URL on the word doc.</p></li>
<li><p>Show and explain how you <strong>prepared the data</strong> so that you can use it properly to Train and Test your models. (You are not required to validate - but you certainly can). Specifically, if you split the data, discuss and illustrate this. If you encode the labels, discuss and illustrate this, etc. Use images (like screenshots) as needed. YOU decide and explain/show what you are doing.</p></li>
<li><p><strong>DO NOT</strong> include or paste any code (to Word doc). You do not need nor should you use “code” to explain or illustrate what you are doing. Use illustrations, images, explanations. Pretend that the person grading this paper does not know Python but does wan to see and understand what you did, what you found, how your models compare, which model worked best, etc.</p></li>
<li><p>TO be clear - You will be coding, training, and then testing three types of models: ANN, CNN, LSTM. Therefore, you should include screen images (small portions) of the training for each (a few of the last epochs), as well as <strong>confusion matrices</strong> for each that illustrate the test data accuracy for each model.</p></li>
<li><p>Discuss and describe what you are doing and showing.</p></li>
<li><p>Discuss and illustrate the results. Which model worked best (have confusion matrices that support this discussion). Comment on which model you expected to work the best, which model actually worked the best and why.</p></li>
</ol></li>
</ol>
<hr>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># %% libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os,sys</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> OneHotEncoder</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow <span class="im">import</span> keras</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras <span class="im">import</span> layers</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow.keras</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.models <span class="im">import</span> Sequential</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.layers <span class="im">import</span> LSTM, Dense, Dropout, LSTM</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.optimizers <span class="im">import</span> Adam</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras <span class="im">import</span> layers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>2023-12-09 08:10:01.312972: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-12-09 08:10:01.518723: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE4.1 SSE4.2 AVX AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># %% working directory</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"current working directory:"</span>, os.getcwd())</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> os.getcwd()[<span class="op">-</span><span class="dv">15</span>:] <span class="op">!=</span> <span class="st">"/CSCI5922/Exam3"</span>:</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    src_file_dir <span class="op">=</span> os.path.abspath(<span class="st">""</span>)          <span class="co"># directory holding this script file</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    src_dir <span class="op">=</span> os.path.dirname(src_file_dir)     <span class="co"># parent directory of above directory</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    os.chdir(src_dir)                           <span class="co"># working directory should now be ".../CSCI5922/Exam3"</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"current working directory:"</span>, os.getcwd())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>current working directory: /home/jasminekobayashi/gh_repos/CSCI5922/Exam3/notebook
current working directory: /home/jasminekobayashi/gh_repos/CSCI5922/Exam3</code></pre>
</div>
</div>
</section>
</section>
<section id="data" class="level1">
<h1>Data</h1>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># %% load data</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_csv(<span class="st">"data/Final_News_DF_Labeled_ExamDataset.csv"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">LABEL</th>
<th data-quarto-table-cell-role="th">according</th>
<th data-quarto-table-cell-role="th">agency</th>
<th data-quarto-table-cell-role="th">ahead</th>
<th data-quarto-table-cell-role="th">alabama</th>
<th data-quarto-table-cell-role="th">amazon</th>
<th data-quarto-table-cell-role="th">america</th>
<th data-quarto-table-cell-role="th">american</th>
<th data-quarto-table-cell-role="th">announced</th>
<th data-quarto-table-cell-role="th">appeared</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">wolverines</th>
<th data-quarto-table-cell-role="th">women</th>
<th data-quarto-table-cell-role="th">work</th>
<th data-quarto-table-cell-role="th">working</th>
<th data-quarto-table-cell-role="th">world</th>
<th data-quarto-table-cell-role="th">wrote</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">years</th>
<th data-quarto-table-cell-role="th">york</th>
<th data-quarto-table-cell-role="th">young</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>politics</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>politics</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>politics</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>politics</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>politics</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>5 rows × 301 columns</p>
</div>
</div>
</div>
<section id="separate-features-targets" class="level2">
<h2 class="anchored" data-anchor-id="separate-features-targets">Separate Features &amp; Targets</h2>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># %% features vs. targets (aka: estimators vs. predictors, input vs. output, etc.)</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> data.drop(columns<span class="op">=</span>[<span class="st">'LABEL'</span>]).to_numpy()     <span class="co"># features: everything except column "LABEL"</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> data[[<span class="st">"LABEL"</span>]]                             <span class="co"># targets: column "LABEL"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preview of X (first 5 rows)</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>X[:<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 1, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preview of y</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>y[:<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">LABEL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>politics</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>politics</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>politics</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>politics</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>politics</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="one-hot-encoder-to-labels" class="level2">
<h2 class="anchored" data-anchor-id="one-hot-encoder-to-labels">One Hot Encoder to Labels</h2>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># %% One Hot encode label</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>OHE <span class="op">=</span> OneHotEncoder()</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> OHE.fit_transform(y).toarray()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>OHE.categories_</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>[array(['football', 'politics', 'science'], dtype=object)]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># preview one hot encoded y</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>y[:<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>array([[0., 1., 0.],
       [0., 1., 0.],
       [0., 1., 0.],
       [0., 1., 0.],
       [0., 1., 0.]])</code></pre>
</div>
</div>
</section>
<section id="training-testing-sets" class="level2">
<h2 class="anchored" data-anchor-id="training-testing-sets">Training &amp; Testing Sets</h2>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># %% Training &amp; Testing set</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>test_size <span class="op">=</span> <span class="fl">0.2</span> <span class="co"># what percent of the data = testing set </span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>X_train,X_test,y_train,y_test <span class="op">=</span> train_test_split(X,y,test_size<span class="op">=</span>test_size,random_state<span class="op">=</span><span class="dv">123</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># preview X_train (first 5 rows)</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>X_train[:<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># preview y_train</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>y_train[:<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>array([[0., 1., 0.],
       [0., 0., 1.],
       [0., 1., 0.],
       [1., 0., 0.],
       [1., 0., 0.]])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test inverse transform of One-Hot Encoder</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>OHE.inverse_transform(y_train[:<span class="dv">5</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>array([['politics'],
       ['science'],
       ['politics'],
       ['football'],
       ['football']], dtype=object)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># preview X_test</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>X_test[:<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [1, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># preview y_test</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>y_test[:<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>array([[0., 0., 1.],
       [0., 1., 0.],
       [0., 1., 0.],
       [0., 1., 0.],
       [1., 0., 0.]])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># preview OHE inverse transform on y_test</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>OHE.inverse_transform(y_test[:<span class="dv">5</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>array([['science'],
       ['politics'],
       ['politics'],
       ['politics'],
       ['football']], dtype=object)</code></pre>
</div>
</div>
</section>
</section>
<section id="models" class="level1">
<h1>Models</h1>
<p>There are some portions of the code that could be relatively repetitive, so rather than just constantly copy and pasting cell codes, I created the following class to help with some redundancy.</p>
<p>The class is built so that after building the model, the desired model to be evaluated is passed into the class when instantiated (and the model summary is outputted during instantiation).</p>
<p>It contains functions that simplify some repetitive process with parameters to change the small details to give flexibility to change if needed depending on the model. Some function may default to have some useful informative outputs (like what loss function was used, data previews, etc.).</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> exam_model_eval:</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>,NN_model,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>                 model_name <span class="op">=</span> <span class="st">'NN Model'</span>,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>                 X_train<span class="op">=</span>X_train,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>                 X_test<span class="op">=</span>X_test,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>                 y_train<span class="op">=</span>y_train,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>                 y_test<span class="op">=</span>y_test,</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>                 OHE<span class="op">=</span>OHE):</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.NN_model <span class="op">=</span> NN_model</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.model_name <span class="op">=</span> model_name</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.OHE <span class="op">=</span> OHE</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.X_train <span class="op">=</span> X_train</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.X_test <span class="op">=</span> X_test</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.y_train <span class="op">=</span> y_train</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.labeled_y_train <span class="op">=</span> <span class="va">self</span>.OHE.inverse_transform(<span class="va">self</span>.y_train) <span class="co">#likely not needed, but potentially useful</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.y_test <span class="op">=</span> y_test</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.labeled_y_test <span class="op">=</span> <span class="va">self</span>.OHE.inverse_transform(<span class="va">self</span>.y_test)</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print model summary</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="va">self</span>.NN_model.summary())</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> compile_model(<span class="va">self</span>, </span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>                      loss <span class="op">=</span> tf.keras.losses.CategoricalCrossentropy(),</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>                      metrics <span class="op">=</span> keras.metrics.CategoricalAccuracy(),</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>                      optimizer <span class="op">=</span> tf.keras.optimizers.legacy.Adam(learning_rate <span class="op">=</span> <span class="fl">0.001</span>)):</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.NN_model.<span class="bu">compile</span>(loss<span class="op">=</span>loss,</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>                              metrics <span class="op">=</span> metrics,</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>                              optimizer <span class="op">=</span> optimizer)</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"Model was compiled (using following parameters):"</span>)</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"Loss Function ="</span>,<span class="bu">str</span>(loss))</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"Accuracy Metric ="</span>,<span class="bu">str</span>(metrics))</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"Optimizer ="</span>,<span class="bu">str</span>(optimizer))</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> train_model(<span class="va">self</span>,epochs <span class="op">=</span> <span class="dv">10</span>):</span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.hist <span class="op">=</span> <span class="va">self</span>.NN_model.fit(<span class="va">self</span>.X_train,</span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>                                         <span class="va">self</span>.y_train,</span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>                                         epochs <span class="op">=</span> epochs,</span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>                                         validation_data <span class="op">=</span>(<span class="va">self</span>.X_test,<span class="va">self</span>.y_test))</span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> accuracy_plot(<span class="va">self</span>,</span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a>                      title <span class="op">=</span> <span class="st">"Accuracy over all Epochs"</span>):</span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Accuracy plot</span></span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a>        plt.plot(<span class="va">self</span>.hist.history[<span class="st">'categorical_accuracy'</span>], label<span class="op">=</span><span class="st">'accuracy'</span>)</span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a>        plt.plot(<span class="va">self</span>.hist.history[<span class="st">'val_categorical_accuracy'</span>], label <span class="op">=</span> <span class="st">'val_accuracy'</span>)</span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a>        plt.xlabel(<span class="st">'Epoch'</span>)</span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a>        plt.ylabel(<span class="st">'Accuracy'</span>)</span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a>        plt.title(title<span class="op">+</span><span class="st">" for </span><span class="sc">{}</span><span class="st">"</span>.<span class="bu">format</span>(<span class="va">self</span>.model_name))</span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true" tabindex="-1"></a>        <span class="co">#plt.ylim([0.5, 1])</span></span>
<span id="cb28-52"><a href="#cb28-52" aria-hidden="true" tabindex="-1"></a>        plt.legend(loc<span class="op">=</span><span class="st">'lower right'</span>)</span>
<span id="cb28-53"><a href="#cb28-53" aria-hidden="true" tabindex="-1"></a>        plt.show()</span>
<span id="cb28-54"><a href="#cb28-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-55"><a href="#cb28-55" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> loss_plot(<span class="va">self</span>,</span>
<span id="cb28-56"><a href="#cb28-56" aria-hidden="true" tabindex="-1"></a>                  title <span class="op">=</span> <span class="st">"Loss over all epochs"</span>):</span>
<span id="cb28-57"><a href="#cb28-57" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Loss plot</span></span>
<span id="cb28-58"><a href="#cb28-58" aria-hidden="true" tabindex="-1"></a>        plt.plot(<span class="va">self</span>.hist.history[<span class="st">'loss'</span>], label<span class="op">=</span><span class="st">'loss'</span>)</span>
<span id="cb28-59"><a href="#cb28-59" aria-hidden="true" tabindex="-1"></a>        plt.plot(<span class="va">self</span>.hist.history[<span class="st">'val_loss'</span>], label <span class="op">=</span> <span class="st">'val_loss'</span>)</span>
<span id="cb28-60"><a href="#cb28-60" aria-hidden="true" tabindex="-1"></a>        plt.xlabel(<span class="st">'Epoch'</span>)</span>
<span id="cb28-61"><a href="#cb28-61" aria-hidden="true" tabindex="-1"></a>        plt.ylabel(<span class="st">'Loss'</span>)</span>
<span id="cb28-62"><a href="#cb28-62" aria-hidden="true" tabindex="-1"></a>        plt.title(title<span class="op">+</span><span class="st">" for </span><span class="sc">{}</span><span class="st"> "</span>.<span class="bu">format</span>(<span class="va">self</span>.model_name))</span>
<span id="cb28-63"><a href="#cb28-63" aria-hidden="true" tabindex="-1"></a>        <span class="co">#plt.ylim([0.5, 1])</span></span>
<span id="cb28-64"><a href="#cb28-64" aria-hidden="true" tabindex="-1"></a>        plt.legend(loc<span class="op">=</span><span class="st">'lower right'</span>)</span>
<span id="cb28-65"><a href="#cb28-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-66"><a href="#cb28-66" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> test_model(<span class="va">self</span>,verbose<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb28-67"><a href="#cb28-67" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.prediction <span class="op">=</span> <span class="va">self</span>.NN_model.predict(<span class="va">self</span>.X_test)</span>
<span id="cb28-68"><a href="#cb28-68" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.labeled_prediction <span class="op">=</span> <span class="va">self</span>.OHE.inverse_transform(<span class="va">self</span>.prediction)</span>
<span id="cb28-69"><a href="#cb28-69" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.eval_loss,<span class="va">self</span>.eval_acc <span class="op">=</span> <span class="va">self</span>.NN_model.evaluate(<span class="va">self</span>.X_test,<span class="va">self</span>.y_test)</span>
<span id="cb28-70"><a href="#cb28-70" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb28-71"><a href="#cb28-71" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> verbose:</span>
<span id="cb28-72"><a href="#cb28-72" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Model Loss from testing:"</span>)</span>
<span id="cb28-73"><a href="#cb28-73" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="va">self</span>.eval_loss)</span>
<span id="cb28-74"><a href="#cb28-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-75"><a href="#cb28-75" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Model Accuracy from testing:"</span>)</span>
<span id="cb28-76"><a href="#cb28-76" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="va">self</span>.eval_acc)</span>
<span id="cb28-77"><a href="#cb28-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-78"><a href="#cb28-78" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Preview of model prediction (raw):"</span>)</span>
<span id="cb28-79"><a href="#cb28-79" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="va">self</span>.prediction[:<span class="dv">5</span>])</span>
<span id="cb28-80"><a href="#cb28-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-81"><a href="#cb28-81" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Preview of predictions labeled:"</span>)</span>
<span id="cb28-82"><a href="#cb28-82" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="va">self</span>.labeled_prediction[:<span class="dv">5</span>])</span>
<span id="cb28-83"><a href="#cb28-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-84"><a href="#cb28-84" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> pretty_confusion_matrix(<span class="va">self</span>,</span>
<span id="cb28-85"><a href="#cb28-85" aria-hidden="true" tabindex="-1"></a>                                title<span class="op">=</span><span class="st">'Confusion Matrix'</span>):</span>
<span id="cb28-86"><a href="#cb28-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-87"><a href="#cb28-87" aria-hidden="true" tabindex="-1"></a>        cm <span class="op">=</span> confusion_matrix(<span class="va">self</span>.labeled_prediction,<span class="va">self</span>.labeled_y_test)</span>
<span id="cb28-88"><a href="#cb28-88" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb28-89"><a href="#cb28-89" aria-hidden="true" tabindex="-1"></a>        fig, ax <span class="op">=</span> plt.subplots() </span>
<span id="cb28-90"><a href="#cb28-90" aria-hidden="true" tabindex="-1"></a>        sns.heatmap(cm, annot<span class="op">=</span><span class="va">True</span>, fmt<span class="op">=</span><span class="st">'g'</span>, ax<span class="op">=</span>ax, annot_kws<span class="op">=</span>{<span class="st">'size'</span>: <span class="dv">18</span>})</span>
<span id="cb28-91"><a href="#cb28-91" aria-hidden="true" tabindex="-1"></a>        ax.set_xlabel(<span class="st">'True labels'</span>) </span>
<span id="cb28-92"><a href="#cb28-92" aria-hidden="true" tabindex="-1"></a>        ax.set_ylabel(<span class="st">'Predicted labels'</span>)</span>
<span id="cb28-93"><a href="#cb28-93" aria-hidden="true" tabindex="-1"></a>        ax.xaxis.set_ticklabels(<span class="va">self</span>.OHE.categories_[<span class="dv">0</span>].tolist())</span>
<span id="cb28-94"><a href="#cb28-94" aria-hidden="true" tabindex="-1"></a>        ax.yaxis.set_ticklabels(<span class="va">self</span>.OHE.categories_[<span class="dv">0</span>].tolist())</span>
<span id="cb28-95"><a href="#cb28-95" aria-hidden="true" tabindex="-1"></a>        ax.set_title(title<span class="op">+</span><span class="st">" of </span><span class="sc">{}</span><span class="st"> Prediction Performance"</span>.<span class="bu">format</span>(<span class="va">self</span>.model_name)) </span>
<span id="cb28-96"><a href="#cb28-96" aria-hidden="true" tabindex="-1"></a>        plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>2023-12-09 08:10:05.160186: E tensorflow/compiler/xla/stream_executor/cuda/cuda_driver.cc:266] failed call to cuInit: UNKNOWN ERROR (100)</code></pre>
</div>
</div>
</section>
<section id="ann" class="level1">
<h1>ANN</h1>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>ANN_model <span class="op">=</span> tf.keras.models.Sequential([</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Dense(<span class="dv">32</span>, activation<span class="op">=</span><span class="st">'relu'</span>), </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Dense(<span class="dv">16</span>, activation<span class="op">=</span><span class="st">'relu'</span>),</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Dropout(<span class="fl">.5</span>), </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Dense(<span class="dv">8</span>, activation<span class="op">=</span><span class="st">'relu'</span>),</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Dropout(<span class="fl">.5</span>), </span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Dense(<span class="dv">3</span>, activation<span class="op">=</span><span class="st">'softmax'</span>)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>ANN_model(X_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>&lt;tf.Tensor: shape=(1194, 3), dtype=float32, numpy=
array([[0.3300434 , 0.356171  , 0.31378558],
       [0.34470907, 0.3285148 , 0.32677612],
       [0.34228167, 0.33214647, 0.3255718 ],
       ...,
       [0.3256445 , 0.33537427, 0.33898118],
       [0.32849354, 0.33508915, 0.3364173 ],
       [0.3455695 , 0.32604873, 0.3283818 ]], dtype=float32)&gt;</code></pre>
</div>
</div>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>my_ANN <span class="op">=</span> exam_model_eval(ANN_model,model_name<span class="op">=</span><span class="st">"ANN_model"</span>) <span class="co">#the init of this class prints the model summary</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 dense (Dense)               (1194, 32)                9632      
                                                                 
 dense_1 (Dense)             (1194, 16)                528       
                                                                 
 dropout (Dropout)           (1194, 16)                0         
                                                                 
 dense_2 (Dense)             (1194, 8)                 136       
                                                                 
 dropout_1 (Dropout)         (1194, 8)                 0         
                                                                 
 dense_3 (Dense)             (1194, 3)                 27        
                                                                 
=================================================================
Total params: 10,323
Trainable params: 10,323
Non-trainable params: 0
_________________________________________________________________
None</code></pre>
</div>
</div>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>my_ANN.compile_model()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model was compiled (using following parameters):
Loss Function = &lt;keras.losses.CategoricalCrossentropy object at 0x7f5f4d4b2fd0&gt;
Accuracy Metric = CategoricalAccuracy(name=categorical_accuracy,dtype=float32)
Optimizer = &lt;keras.optimizers.legacy.adam.Adam object at 0x7f5f4d4cb310&gt;</code></pre>
</div>
</div>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>time</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>my_ANN.train_model(epochs<span class="op">=</span><span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/100
38/38 [==============================] - 1s 13ms/step - loss: 1.0870 - categorical_accuracy: 0.3626 - val_loss: 1.0778 - val_categorical_accuracy: 0.3913
Epoch 2/100
25/38 [==================&gt;...........] - ETA: 0s - loss: 1.0733 - categorical_accuracy: 0.400038/38 [==============================] - 0s 6ms/step - loss: 1.0726 - categorical_accuracy: 0.3802 - val_loss: 1.0542 - val_categorical_accuracy: 0.5485
Epoch 3/100
38/38 [==============================] - 0s 5ms/step - loss: 1.0500 - categorical_accuracy: 0.4162 - val_loss: 1.0248 - val_categorical_accuracy: 0.5953
Epoch 4/100
38/38 [==============================] - 0s 4ms/step - loss: 1.0257 - categorical_accuracy: 0.4271 - val_loss: 0.9781 - val_categorical_accuracy: 0.6455
Epoch 5/100
38/38 [==============================] - 0s 4ms/step - loss: 0.9868 - categorical_accuracy: 0.4791 - val_loss: 0.9164 - val_categorical_accuracy: 0.6622
Epoch 6/100
38/38 [==============================] - 0s 4ms/step - loss: 0.9497 - categorical_accuracy: 0.4874 - val_loss: 0.8637 - val_categorical_accuracy: 0.6722
Epoch 7/100
38/38 [==============================] - 0s 4ms/step - loss: 0.9037 - categorical_accuracy: 0.5126 - val_loss: 0.8090 - val_categorical_accuracy: 0.6890
Epoch 8/100
38/38 [==============================] - 0s 4ms/step - loss: 0.8912 - categorical_accuracy: 0.5134 - val_loss: 0.7683 - val_categorical_accuracy: 0.6823
Epoch 9/100
38/38 [==============================] - 0s 5ms/step - loss: 0.8337 - categorical_accuracy: 0.5578 - val_loss: 0.7248 - val_categorical_accuracy: 0.7157
Epoch 10/100
38/38 [==============================] - 0s 4ms/step - loss: 0.8116 - categorical_accuracy: 0.5754 - val_loss: 0.6986 - val_categorical_accuracy: 0.7425
Epoch 11/100
38/38 [==============================] - 0s 5ms/step - loss: 0.7843 - categorical_accuracy: 0.6072 - val_loss: 0.6722 - val_categorical_accuracy: 0.7358
Epoch 12/100
38/38 [==============================] - 0s 5ms/step - loss: 0.7751 - categorical_accuracy: 0.6432 - val_loss: 0.6455 - val_categorical_accuracy: 0.7458
Epoch 13/100
38/38 [==============================] - 0s 5ms/step - loss: 0.7436 - categorical_accuracy: 0.6910 - val_loss: 0.6261 - val_categorical_accuracy: 0.7358
Epoch 14/100
38/38 [==============================] - 0s 5ms/step - loss: 0.7087 - categorical_accuracy: 0.6935 - val_loss: 0.6105 - val_categorical_accuracy: 0.7492
Epoch 15/100
38/38 [==============================] - 0s 5ms/step - loss: 0.6604 - categorical_accuracy: 0.7018 - val_loss: 0.6074 - val_categorical_accuracy: 0.7492
Epoch 16/100
38/38 [==============================] - 0s 4ms/step - loss: 0.6473 - categorical_accuracy: 0.7144 - val_loss: 0.6032 - val_categorical_accuracy: 0.7425
Epoch 17/100
38/38 [==============================] - 0s 5ms/step - loss: 0.6371 - categorical_accuracy: 0.7295 - val_loss: 0.6034 - val_categorical_accuracy: 0.7391
Epoch 18/100
38/38 [==============================] - 0s 4ms/step - loss: 0.6271 - categorical_accuracy: 0.7219 - val_loss: 0.6149 - val_categorical_accuracy: 0.7391
Epoch 19/100
38/38 [==============================] - 0s 5ms/step - loss: 0.6150 - categorical_accuracy: 0.7370 - val_loss: 0.6073 - val_categorical_accuracy: 0.7358
Epoch 20/100
38/38 [==============================] - 0s 4ms/step - loss: 0.6247 - categorical_accuracy: 0.7395 - val_loss: 0.6141 - val_categorical_accuracy: 0.7559
Epoch 21/100
38/38 [==============================] - 0s 5ms/step - loss: 0.5900 - categorical_accuracy: 0.7479 - val_loss: 0.6121 - val_categorical_accuracy: 0.7425
Epoch 22/100
38/38 [==============================] - 0s 5ms/step - loss: 0.5577 - categorical_accuracy: 0.7663 - val_loss: 0.6133 - val_categorical_accuracy: 0.7458
Epoch 23/100
38/38 [==============================] - 0s 4ms/step - loss: 0.5376 - categorical_accuracy: 0.7806 - val_loss: 0.6229 - val_categorical_accuracy: 0.7559
Epoch 24/100
38/38 [==============================] - 0s 4ms/step - loss: 0.5041 - categorical_accuracy: 0.7923 - val_loss: 0.6459 - val_categorical_accuracy: 0.7391
Epoch 25/100
38/38 [==============================] - 0s 4ms/step - loss: 0.5363 - categorical_accuracy: 0.7730 - val_loss: 0.6522 - val_categorical_accuracy: 0.7324
Epoch 26/100
38/38 [==============================] - 0s 4ms/step - loss: 0.5542 - categorical_accuracy: 0.7739 - val_loss: 0.6673 - val_categorical_accuracy: 0.7291
Epoch 27/100
38/38 [==============================] - 0s 4ms/step - loss: 0.5376 - categorical_accuracy: 0.7714 - val_loss: 0.6825 - val_categorical_accuracy: 0.7358
Epoch 28/100
38/38 [==============================] - 0s 5ms/step - loss: 0.4764 - categorical_accuracy: 0.8082 - val_loss: 0.7023 - val_categorical_accuracy: 0.7291
Epoch 29/100
38/38 [==============================] - 0s 4ms/step - loss: 0.4766 - categorical_accuracy: 0.8141 - val_loss: 0.7110 - val_categorical_accuracy: 0.7291
Epoch 30/100
38/38 [==============================] - 0s 4ms/step - loss: 0.4708 - categorical_accuracy: 0.7956 - val_loss: 0.7091 - val_categorical_accuracy: 0.7224
Epoch 31/100
38/38 [==============================] - 0s 5ms/step - loss: 0.4719 - categorical_accuracy: 0.8199 - val_loss: 0.7550 - val_categorical_accuracy: 0.7090
Epoch 32/100
38/38 [==============================] - 0s 5ms/step - loss: 0.4543 - categorical_accuracy: 0.8191 - val_loss: 0.7572 - val_categorical_accuracy: 0.7258
Epoch 33/100
38/38 [==============================] - 0s 5ms/step - loss: 0.4482 - categorical_accuracy: 0.8191 - val_loss: 0.7850 - val_categorical_accuracy: 0.7291
Epoch 34/100
38/38 [==============================] - 0s 5ms/step - loss: 0.4516 - categorical_accuracy: 0.8132 - val_loss: 0.7904 - val_categorical_accuracy: 0.7224
Epoch 35/100
38/38 [==============================] - 0s 5ms/step - loss: 0.4558 - categorical_accuracy: 0.8317 - val_loss: 0.8267 - val_categorical_accuracy: 0.7157
Epoch 36/100
38/38 [==============================] - 0s 5ms/step - loss: 0.4245 - categorical_accuracy: 0.8266 - val_loss: 0.8314 - val_categorical_accuracy: 0.7224
Epoch 37/100
38/38 [==============================] - 0s 5ms/step - loss: 0.4308 - categorical_accuracy: 0.8275 - val_loss: 0.8752 - val_categorical_accuracy: 0.7124
Epoch 38/100
38/38 [==============================] - 0s 5ms/step - loss: 0.4249 - categorical_accuracy: 0.8375 - val_loss: 0.9098 - val_categorical_accuracy: 0.7191
Epoch 39/100
38/38 [==============================] - 0s 6ms/step - loss: 0.4223 - categorical_accuracy: 0.8291 - val_loss: 0.9093 - val_categorical_accuracy: 0.7324
Epoch 40/100
38/38 [==============================] - 0s 4ms/step - loss: 0.3979 - categorical_accuracy: 0.8501 - val_loss: 0.9270 - val_categorical_accuracy: 0.7224
Epoch 41/100
38/38 [==============================] - 0s 4ms/step - loss: 0.4100 - categorical_accuracy: 0.8400 - val_loss: 0.9330 - val_categorical_accuracy: 0.7124
Epoch 42/100
38/38 [==============================] - 0s 4ms/step - loss: 0.3848 - categorical_accuracy: 0.8501 - val_loss: 0.9831 - val_categorical_accuracy: 0.7291
Epoch 43/100
38/38 [==============================] - 0s 5ms/step - loss: 0.4059 - categorical_accuracy: 0.8375 - val_loss: 0.9721 - val_categorical_accuracy: 0.7291
Epoch 44/100
38/38 [==============================] - 0s 4ms/step - loss: 0.4019 - categorical_accuracy: 0.8392 - val_loss: 1.0016 - val_categorical_accuracy: 0.7258
Epoch 45/100
38/38 [==============================] - 0s 5ms/step - loss: 0.4198 - categorical_accuracy: 0.8250 - val_loss: 0.9926 - val_categorical_accuracy: 0.7291
Epoch 46/100
38/38 [==============================] - 0s 5ms/step - loss: 0.3870 - categorical_accuracy: 0.8451 - val_loss: 1.0253 - val_categorical_accuracy: 0.7191
Epoch 47/100
38/38 [==============================] - 0s 5ms/step - loss: 0.3714 - categorical_accuracy: 0.8568 - val_loss: 1.0136 - val_categorical_accuracy: 0.7191
Epoch 48/100
38/38 [==============================] - 0s 4ms/step - loss: 0.3780 - categorical_accuracy: 0.8417 - val_loss: 1.0240 - val_categorical_accuracy: 0.7224
Epoch 49/100
38/38 [==============================] - 0s 5ms/step - loss: 0.4115 - categorical_accuracy: 0.8308 - val_loss: 1.0633 - val_categorical_accuracy: 0.7191
Epoch 50/100
38/38 [==============================] - 0s 5ms/step - loss: 0.3818 - categorical_accuracy: 0.8484 - val_loss: 1.0974 - val_categorical_accuracy: 0.7057
Epoch 51/100
38/38 [==============================] - 0s 5ms/step - loss: 0.3695 - categorical_accuracy: 0.8534 - val_loss: 1.1342 - val_categorical_accuracy: 0.7124
Epoch 52/100
38/38 [==============================] - 0s 5ms/step - loss: 0.3698 - categorical_accuracy: 0.8568 - val_loss: 1.1207 - val_categorical_accuracy: 0.7124
Epoch 53/100
38/38 [==============================] - 0s 5ms/step - loss: 0.3693 - categorical_accuracy: 0.8543 - val_loss: 1.1488 - val_categorical_accuracy: 0.7258
Epoch 54/100
38/38 [==============================] - 0s 4ms/step - loss: 0.3690 - categorical_accuracy: 0.8451 - val_loss: 1.1939 - val_categorical_accuracy: 0.7224
Epoch 55/100
38/38 [==============================] - 0s 5ms/step - loss: 0.3587 - categorical_accuracy: 0.8551 - val_loss: 1.2178 - val_categorical_accuracy: 0.7124
Epoch 56/100
38/38 [==============================] - 0s 5ms/step - loss: 0.3732 - categorical_accuracy: 0.8501 - val_loss: 1.2067 - val_categorical_accuracy: 0.7224
Epoch 57/100
38/38 [==============================] - 0s 4ms/step - loss: 0.3448 - categorical_accuracy: 0.8601 - val_loss: 1.2349 - val_categorical_accuracy: 0.7324
Epoch 58/100
38/38 [==============================] - 0s 4ms/step - loss: 0.3630 - categorical_accuracy: 0.8618 - val_loss: 1.2853 - val_categorical_accuracy: 0.7324
Epoch 59/100
38/38 [==============================] - 0s 5ms/step - loss: 0.3558 - categorical_accuracy: 0.8652 - val_loss: 1.2671 - val_categorical_accuracy: 0.7291
Epoch 60/100
38/38 [==============================] - 0s 4ms/step - loss: 0.3631 - categorical_accuracy: 0.8551 - val_loss: 1.3087 - val_categorical_accuracy: 0.7258
Epoch 61/100
38/38 [==============================] - 0s 5ms/step - loss: 0.3567 - categorical_accuracy: 0.8492 - val_loss: 1.2864 - val_categorical_accuracy: 0.7258
Epoch 62/100
38/38 [==============================] - 0s 5ms/step - loss: 0.3182 - categorical_accuracy: 0.8786 - val_loss: 1.3104 - val_categorical_accuracy: 0.7224
Epoch 63/100
38/38 [==============================] - 0s 6ms/step - loss: 0.3428 - categorical_accuracy: 0.8735 - val_loss: 1.3266 - val_categorical_accuracy: 0.7258
Epoch 64/100
38/38 [==============================] - 0s 4ms/step - loss: 0.3343 - categorical_accuracy: 0.8677 - val_loss: 1.3660 - val_categorical_accuracy: 0.7224
Epoch 65/100
38/38 [==============================] - 0s 5ms/step - loss: 0.3375 - categorical_accuracy: 0.8677 - val_loss: 1.3905 - val_categorical_accuracy: 0.7224
Epoch 66/100
38/38 [==============================] - 0s 4ms/step - loss: 0.3573 - categorical_accuracy: 0.8442 - val_loss: 1.4266 - val_categorical_accuracy: 0.7191
Epoch 67/100
38/38 [==============================] - 0s 4ms/step - loss: 0.3319 - categorical_accuracy: 0.8660 - val_loss: 1.4658 - val_categorical_accuracy: 0.7224
Epoch 68/100
38/38 [==============================] - 0s 5ms/step - loss: 0.3239 - categorical_accuracy: 0.8702 - val_loss: 1.4783 - val_categorical_accuracy: 0.7224
Epoch 69/100
38/38 [==============================] - 0s 4ms/step - loss: 0.3477 - categorical_accuracy: 0.8526 - val_loss: 1.5059 - val_categorical_accuracy: 0.7258
Epoch 70/100
38/38 [==============================] - 0s 5ms/step - loss: 0.3401 - categorical_accuracy: 0.8677 - val_loss: 1.5598 - val_categorical_accuracy: 0.7258
Epoch 71/100
38/38 [==============================] - 0s 5ms/step - loss: 0.3215 - categorical_accuracy: 0.8727 - val_loss: 1.6066 - val_categorical_accuracy: 0.7358
Epoch 72/100
38/38 [==============================] - 0s 5ms/step - loss: 0.3089 - categorical_accuracy: 0.8693 - val_loss: 1.6435 - val_categorical_accuracy: 0.7258
Epoch 73/100
38/38 [==============================] - 0s 4ms/step - loss: 0.3340 - categorical_accuracy: 0.8710 - val_loss: 1.6740 - val_categorical_accuracy: 0.7191
Epoch 74/100
38/38 [==============================] - 0s 4ms/step - loss: 0.3406 - categorical_accuracy: 0.8576 - val_loss: 1.5379 - val_categorical_accuracy: 0.7258
Epoch 75/100
38/38 [==============================] - 0s 4ms/step - loss: 0.3363 - categorical_accuracy: 0.8702 - val_loss: 1.5990 - val_categorical_accuracy: 0.7191
Epoch 76/100
38/38 [==============================] - 0s 5ms/step - loss: 0.3268 - categorical_accuracy: 0.8727 - val_loss: 1.6428 - val_categorical_accuracy: 0.7258
Epoch 77/100
38/38 [==============================] - 0s 6ms/step - loss: 0.3260 - categorical_accuracy: 0.8601 - val_loss: 1.6735 - val_categorical_accuracy: 0.7258
Epoch 78/100
38/38 [==============================] - 0s 5ms/step - loss: 0.3432 - categorical_accuracy: 0.8593 - val_loss: 1.7133 - val_categorical_accuracy: 0.7258
Epoch 79/100
38/38 [==============================] - 0s 4ms/step - loss: 0.3164 - categorical_accuracy: 0.8719 - val_loss: 1.7367 - val_categorical_accuracy: 0.7191
Epoch 80/100
38/38 [==============================] - 0s 4ms/step - loss: 0.3265 - categorical_accuracy: 0.8635 - val_loss: 1.7803 - val_categorical_accuracy: 0.7191
Epoch 81/100
38/38 [==============================] - 0s 5ms/step - loss: 0.3267 - categorical_accuracy: 0.8593 - val_loss: 1.7423 - val_categorical_accuracy: 0.7191
Epoch 82/100
38/38 [==============================] - 0s 5ms/step - loss: 0.3546 - categorical_accuracy: 0.8601 - val_loss: 1.7925 - val_categorical_accuracy: 0.7191
Epoch 83/100
38/38 [==============================] - 0s 5ms/step - loss: 0.3151 - categorical_accuracy: 0.8744 - val_loss: 1.8099 - val_categorical_accuracy: 0.7224
Epoch 84/100
38/38 [==============================] - 0s 6ms/step - loss: 0.3268 - categorical_accuracy: 0.8626 - val_loss: 1.8387 - val_categorical_accuracy: 0.7224
Epoch 85/100
38/38 [==============================] - 0s 5ms/step - loss: 0.3341 - categorical_accuracy: 0.8601 - val_loss: 1.9032 - val_categorical_accuracy: 0.7291
Epoch 86/100
38/38 [==============================] - 0s 5ms/step - loss: 0.3254 - categorical_accuracy: 0.8635 - val_loss: 1.8541 - val_categorical_accuracy: 0.7291
Epoch 87/100
38/38 [==============================] - 0s 5ms/step - loss: 0.3373 - categorical_accuracy: 0.8685 - val_loss: 1.8615 - val_categorical_accuracy: 0.7258
Epoch 88/100
38/38 [==============================] - 0s 5ms/step - loss: 0.3231 - categorical_accuracy: 0.8727 - val_loss: 1.8996 - val_categorical_accuracy: 0.7224
Epoch 89/100
38/38 [==============================] - 0s 4ms/step - loss: 0.3167 - categorical_accuracy: 0.8735 - val_loss: 1.9807 - val_categorical_accuracy: 0.7090
Epoch 90/100
38/38 [==============================] - 0s 4ms/step - loss: 0.3397 - categorical_accuracy: 0.8610 - val_loss: 1.9110 - val_categorical_accuracy: 0.7090
Epoch 91/100
38/38 [==============================] - 0s 4ms/step - loss: 0.3272 - categorical_accuracy: 0.8635 - val_loss: 1.8899 - val_categorical_accuracy: 0.7124
Epoch 92/100
38/38 [==============================] - 0s 4ms/step - loss: 0.3249 - categorical_accuracy: 0.8568 - val_loss: 1.9580 - val_categorical_accuracy: 0.7191
Epoch 93/100
38/38 [==============================] - 0s 4ms/step - loss: 0.3199 - categorical_accuracy: 0.8744 - val_loss: 1.9776 - val_categorical_accuracy: 0.7124
Epoch 94/100
38/38 [==============================] - 0s 4ms/step - loss: 0.3025 - categorical_accuracy: 0.8819 - val_loss: 1.9646 - val_categorical_accuracy: 0.7191
Epoch 95/100
38/38 [==============================] - 0s 4ms/step - loss: 0.3239 - categorical_accuracy: 0.8610 - val_loss: 2.0099 - val_categorical_accuracy: 0.7191
Epoch 96/100
38/38 [==============================] - 0s 4ms/step - loss: 0.3060 - categorical_accuracy: 0.8786 - val_loss: 1.9749 - val_categorical_accuracy: 0.7124
Epoch 97/100
38/38 [==============================] - 0s 5ms/step - loss: 0.3209 - categorical_accuracy: 0.8735 - val_loss: 2.0007 - val_categorical_accuracy: 0.7224
Epoch 98/100
38/38 [==============================] - 0s 4ms/step - loss: 0.3299 - categorical_accuracy: 0.8593 - val_loss: 1.9916 - val_categorical_accuracy: 0.7224
Epoch 99/100
38/38 [==============================] - 0s 5ms/step - loss: 0.3154 - categorical_accuracy: 0.8719 - val_loss: 2.0788 - val_categorical_accuracy: 0.7224
Epoch 100/100
38/38 [==============================] - 0s 5ms/step - loss: 0.3157 - categorical_accuracy: 0.8719 - val_loss: 2.1013 - val_categorical_accuracy: 0.7191
CPU times: user 22.4 s, sys: 6.63 s, total: 29 s
Wall time: 19.3 s</code></pre>
</div>
</div>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>my_ANN.accuracy_plot()</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>my_ANN.loss_plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="JasmineKobayashi_NN_Exam_2023_files/figure-html/cell-23-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="JasmineKobayashi_NN_Exam_2023_files/figure-html/cell-23-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>my_ANN.test_model(verbose<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>10/10 [==============================] - 0s 2ms/step
10/10 [==============================] - 0s 4ms/step - loss: 2.1013 - categorical_accuracy: 0.7191

Model Loss from testing:
2.1013288497924805

Model Accuracy from testing:
0.7190635204315186

Preview of model prediction (raw):
[[2.41240965e-08 5.36647385e-05 9.99946356e-01]
 [7.39151597e-01 1.22635566e-01 1.38212845e-01]
 [8.89783332e-05 8.46713036e-02 9.15239632e-01]
 [1.66180371e-06 9.77494055e-04 9.99020815e-01]
 [1.00000000e+00 7.61282237e-09 4.10697904e-18]]

Preview of predictions labeled:
[['science']
 ['football']
 ['science']
 ['science']
 ['football']]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>my_ANN.pretty_confusion_matrix()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="JasmineKobayashi_NN_Exam_2023_files/figure-html/cell-25-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="cnn" class="level1">
<h1>CNN</h1>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>CNN_model <span class="op">=</span> tf.keras.models.Sequential([</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Conv1D(<span class="dv">50</span>,input_shape <span class="op">=</span> (X_train.shape[<span class="dv">1</span>],<span class="dv">1</span>), kernel_size<span class="op">=</span><span class="dv">3</span>, activation<span class="op">=</span><span class="st">'relu'</span>),</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.MaxPool1D(pool_size<span class="op">=</span><span class="dv">2</span>),</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Conv1D(<span class="dv">40</span>, kernel_size<span class="op">=</span><span class="dv">3</span>, activation<span class="op">=</span><span class="st">'relu'</span>),</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.MaxPool1D(pool_size<span class="op">=</span><span class="dv">2</span>),</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Conv1D(<span class="dv">30</span>, kernel_size<span class="op">=</span><span class="dv">3</span>, activation<span class="op">=</span><span class="st">'relu'</span>),</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.MaxPool1D(pool_size<span class="op">=</span><span class="dv">2</span>),</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Conv1D(<span class="dv">30</span>, kernel_size<span class="op">=</span><span class="dv">3</span>, activation<span class="op">=</span><span class="st">'relu'</span>),</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.MaxPool1D(pool_size<span class="op">=</span><span class="dv">2</span>),</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Flatten(),</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Dense(<span class="dv">20</span>),</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Dropout(<span class="fl">0.5</span>),</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>  tf.keras.layers.Dense(<span class="dv">3</span>, activation<span class="op">=</span><span class="st">'softmax'</span>)</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>my_CNN <span class="op">=</span> exam_model_eval(CNN_model,model_name<span class="op">=</span><span class="st">"CNN Model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_1"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 conv1d (Conv1D)             (None, 298, 50)           200       
                                                                 
 max_pooling1d (MaxPooling1D  (None, 149, 50)          0         
 )                                                               
                                                                 
 conv1d_1 (Conv1D)           (None, 147, 40)           6040      
                                                                 
 max_pooling1d_1 (MaxPooling  (None, 73, 40)           0         
 1D)                                                             
                                                                 
 conv1d_2 (Conv1D)           (None, 71, 30)            3630      
                                                                 
 max_pooling1d_2 (MaxPooling  (None, 35, 30)           0         
 1D)                                                             
                                                                 
 conv1d_3 (Conv1D)           (None, 33, 30)            2730      
                                                                 
 max_pooling1d_3 (MaxPooling  (None, 16, 30)           0         
 1D)                                                             
                                                                 
 flatten (Flatten)           (None, 480)               0         
                                                                 
 dense_4 (Dense)             (None, 20)                9620      
                                                                 
 dropout_2 (Dropout)         (None, 20)                0         
                                                                 
 dense_5 (Dense)             (None, 3)                 63        
                                                                 
=================================================================
Total params: 22,283
Trainable params: 22,283
Non-trainable params: 0
_________________________________________________________________
None</code></pre>
</div>
</div>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>my_CNN.compile_model()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model was compiled (using following parameters):
Loss Function = &lt;keras.losses.CategoricalCrossentropy object at 0x7f5f4d4b2fd0&gt;
Accuracy Metric = CategoricalAccuracy(name=categorical_accuracy,dtype=float32)
Optimizer = &lt;keras.optimizers.legacy.adam.Adam object at 0x7f5f4d4cb310&gt;</code></pre>
</div>
</div>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>time</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>my_CNN.train_model(epochs<span class="op">=</span><span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/100
38/38 [==============================] - 2s 26ms/step - loss: 0.9770 - categorical_accuracy: 0.5338 - val_loss: 0.8775 - val_categorical_accuracy: 0.5518
Epoch 2/100
38/38 [==============================] - 1s 15ms/step - loss: 0.8273 - categorical_accuracy: 0.6089 - val_loss: 0.7695 - val_categorical_accuracy: 0.6589
Epoch 3/100
38/38 [==============================] - 1s 14ms/step - loss: 0.7188 - categorical_accuracy: 0.6901 - val_loss: 0.7521 - val_categorical_accuracy: 0.6756
Epoch 4/100
38/38 [==============================] - 1s 14ms/step - loss: 0.6638 - categorical_accuracy: 0.7236 - val_loss: 0.7218 - val_categorical_accuracy: 0.6656
Epoch 5/100
38/38 [==============================] - 1s 14ms/step - loss: 0.6349 - categorical_accuracy: 0.7211 - val_loss: 0.7204 - val_categorical_accuracy: 0.6789
Epoch 6/100
38/38 [==============================] - 1s 14ms/step - loss: 0.5935 - categorical_accuracy: 0.7613 - val_loss: 0.7371 - val_categorical_accuracy: 0.6689
Epoch 7/100
38/38 [==============================] - 1s 15ms/step - loss: 0.5725 - categorical_accuracy: 0.7672 - val_loss: 0.7148 - val_categorical_accuracy: 0.6656
Epoch 8/100
38/38 [==============================] - 1s 14ms/step - loss: 0.5516 - categorical_accuracy: 0.7688 - val_loss: 0.7356 - val_categorical_accuracy: 0.6823
Epoch 9/100
38/38 [==============================] - 1s 14ms/step - loss: 0.5264 - categorical_accuracy: 0.7789 - val_loss: 0.7758 - val_categorical_accuracy: 0.6823
Epoch 10/100
38/38 [==============================] - 1s 14ms/step - loss: 0.5246 - categorical_accuracy: 0.7739 - val_loss: 0.7981 - val_categorical_accuracy: 0.6589
Epoch 11/100
38/38 [==============================] - 1s 14ms/step - loss: 0.4930 - categorical_accuracy: 0.7940 - val_loss: 0.8180 - val_categorical_accuracy: 0.6856
Epoch 12/100
38/38 [==============================] - 1s 15ms/step - loss: 0.4804 - categorical_accuracy: 0.7915 - val_loss: 0.7834 - val_categorical_accuracy: 0.6957
Epoch 13/100
38/38 [==============================] - 1s 15ms/step - loss: 0.4770 - categorical_accuracy: 0.8023 - val_loss: 0.8116 - val_categorical_accuracy: 0.6689
Epoch 14/100
38/38 [==============================] - 1s 16ms/step - loss: 0.4659 - categorical_accuracy: 0.8057 - val_loss: 0.8141 - val_categorical_accuracy: 0.6823
Epoch 15/100
38/38 [==============================] - 1s 15ms/step - loss: 0.4490 - categorical_accuracy: 0.8166 - val_loss: 0.8372 - val_categorical_accuracy: 0.6555
Epoch 16/100
38/38 [==============================] - 1s 16ms/step - loss: 0.4486 - categorical_accuracy: 0.8199 - val_loss: 0.9034 - val_categorical_accuracy: 0.6589
Epoch 17/100
38/38 [==============================] - 1s 15ms/step - loss: 0.4287 - categorical_accuracy: 0.8275 - val_loss: 0.9073 - val_categorical_accuracy: 0.6555
Epoch 18/100
38/38 [==============================] - 1s 15ms/step - loss: 0.4400 - categorical_accuracy: 0.8166 - val_loss: 0.9455 - val_categorical_accuracy: 0.6555
Epoch 19/100
38/38 [==============================] - 1s 16ms/step - loss: 0.4117 - categorical_accuracy: 0.8375 - val_loss: 0.9598 - val_categorical_accuracy: 0.6722
Epoch 20/100
38/38 [==============================] - 1s 18ms/step - loss: 0.4224 - categorical_accuracy: 0.8283 - val_loss: 0.9827 - val_categorical_accuracy: 0.6555
Epoch 21/100
38/38 [==============================] - 1s 15ms/step - loss: 0.4107 - categorical_accuracy: 0.8283 - val_loss: 0.9686 - val_categorical_accuracy: 0.6555
Epoch 22/100
38/38 [==============================] - 1s 15ms/step - loss: 0.4185 - categorical_accuracy: 0.8250 - val_loss: 0.9547 - val_categorical_accuracy: 0.6622
Epoch 23/100
38/38 [==============================] - 1s 14ms/step - loss: 0.4246 - categorical_accuracy: 0.8241 - val_loss: 0.9739 - val_categorical_accuracy: 0.6622
Epoch 24/100
38/38 [==============================] - 1s 15ms/step - loss: 0.3892 - categorical_accuracy: 0.8384 - val_loss: 1.0293 - val_categorical_accuracy: 0.6522
Epoch 25/100
38/38 [==============================] - 1s 15ms/step - loss: 0.3947 - categorical_accuracy: 0.8392 - val_loss: 1.0104 - val_categorical_accuracy: 0.6656
Epoch 26/100
38/38 [==============================] - 1s 17ms/step - loss: 0.3611 - categorical_accuracy: 0.8484 - val_loss: 1.1066 - val_categorical_accuracy: 0.6656
Epoch 27/100
38/38 [==============================] - 1s 16ms/step - loss: 0.3827 - categorical_accuracy: 0.8467 - val_loss: 1.0824 - val_categorical_accuracy: 0.6656
Epoch 28/100
38/38 [==============================] - 1s 17ms/step - loss: 0.3718 - categorical_accuracy: 0.8375 - val_loss: 1.1291 - val_categorical_accuracy: 0.6555
Epoch 29/100
38/38 [==============================] - 1s 18ms/step - loss: 0.3672 - categorical_accuracy: 0.8518 - val_loss: 1.1379 - val_categorical_accuracy: 0.6689
Epoch 30/100
38/38 [==============================] - 1s 16ms/step - loss: 0.3562 - categorical_accuracy: 0.8543 - val_loss: 1.1545 - val_categorical_accuracy: 0.6622
Epoch 31/100
38/38 [==============================] - 1s 16ms/step - loss: 0.3634 - categorical_accuracy: 0.8526 - val_loss: 1.1846 - val_categorical_accuracy: 0.6455
Epoch 32/100
38/38 [==============================] - 1s 16ms/step - loss: 0.3498 - categorical_accuracy: 0.8442 - val_loss: 1.1972 - val_categorical_accuracy: 0.6321
Epoch 33/100
38/38 [==============================] - 1s 16ms/step - loss: 0.3609 - categorical_accuracy: 0.8467 - val_loss: 1.1921 - val_categorical_accuracy: 0.6421
Epoch 34/100
38/38 [==============================] - 1s 16ms/step - loss: 0.3588 - categorical_accuracy: 0.8526 - val_loss: 1.1811 - val_categorical_accuracy: 0.6455
Epoch 35/100
38/38 [==============================] - 1s 14ms/step - loss: 0.3439 - categorical_accuracy: 0.8518 - val_loss: 1.2468 - val_categorical_accuracy: 0.6455
Epoch 36/100
38/38 [==============================] - 1s 15ms/step - loss: 0.3396 - categorical_accuracy: 0.8643 - val_loss: 1.2094 - val_categorical_accuracy: 0.6589
Epoch 37/100
38/38 [==============================] - 1s 17ms/step - loss: 0.3332 - categorical_accuracy: 0.8668 - val_loss: 1.3129 - val_categorical_accuracy: 0.6656
Epoch 38/100
38/38 [==============================] - 1s 14ms/step - loss: 0.3276 - categorical_accuracy: 0.8543 - val_loss: 1.2989 - val_categorical_accuracy: 0.6589
Epoch 39/100
38/38 [==============================] - 1s 16ms/step - loss: 0.3480 - categorical_accuracy: 0.8626 - val_loss: 1.2741 - val_categorical_accuracy: 0.6488
Epoch 40/100
38/38 [==============================] - 1s 17ms/step - loss: 0.3308 - categorical_accuracy: 0.8626 - val_loss: 1.3203 - val_categorical_accuracy: 0.6522
Epoch 41/100
38/38 [==============================] - 1s 15ms/step - loss: 0.3190 - categorical_accuracy: 0.8652 - val_loss: 1.3880 - val_categorical_accuracy: 0.6321
Epoch 42/100
38/38 [==============================] - 1s 15ms/step - loss: 0.3381 - categorical_accuracy: 0.8601 - val_loss: 1.3962 - val_categorical_accuracy: 0.6288
Epoch 43/100
38/38 [==============================] - 1s 13ms/step - loss: 0.3230 - categorical_accuracy: 0.8668 - val_loss: 1.3518 - val_categorical_accuracy: 0.6421
Epoch 44/100
38/38 [==============================] - 1s 16ms/step - loss: 0.3282 - categorical_accuracy: 0.8551 - val_loss: 1.3619 - val_categorical_accuracy: 0.6321
Epoch 45/100
38/38 [==============================] - 1s 16ms/step - loss: 0.3115 - categorical_accuracy: 0.8702 - val_loss: 1.5019 - val_categorical_accuracy: 0.6321
Epoch 46/100
38/38 [==============================] - 1s 16ms/step - loss: 0.3267 - categorical_accuracy: 0.8652 - val_loss: 1.3266 - val_categorical_accuracy: 0.6488
Epoch 47/100
38/38 [==============================] - 1s 17ms/step - loss: 0.3153 - categorical_accuracy: 0.8643 - val_loss: 1.4508 - val_categorical_accuracy: 0.6622
Epoch 48/100
38/38 [==============================] - 1s 15ms/step - loss: 0.2956 - categorical_accuracy: 0.8693 - val_loss: 1.4747 - val_categorical_accuracy: 0.6555
Epoch 49/100
38/38 [==============================] - 1s 15ms/step - loss: 0.3212 - categorical_accuracy: 0.8660 - val_loss: 1.5250 - val_categorical_accuracy: 0.6388
Epoch 50/100
38/38 [==============================] - 1s 16ms/step - loss: 0.3063 - categorical_accuracy: 0.8752 - val_loss: 1.5012 - val_categorical_accuracy: 0.6488
Epoch 51/100
38/38 [==============================] - 1s 15ms/step - loss: 0.3128 - categorical_accuracy: 0.8685 - val_loss: 1.5328 - val_categorical_accuracy: 0.6388
Epoch 52/100
38/38 [==============================] - 1s 14ms/step - loss: 0.3031 - categorical_accuracy: 0.8693 - val_loss: 1.4978 - val_categorical_accuracy: 0.6321
Epoch 53/100
38/38 [==============================] - 0s 13ms/step - loss: 0.2943 - categorical_accuracy: 0.8719 - val_loss: 1.4956 - val_categorical_accuracy: 0.6254
Epoch 54/100
38/38 [==============================] - 1s 17ms/step - loss: 0.3078 - categorical_accuracy: 0.8693 - val_loss: 1.5906 - val_categorical_accuracy: 0.6221
Epoch 55/100
38/38 [==============================] - 1s 16ms/step - loss: 0.2903 - categorical_accuracy: 0.8769 - val_loss: 1.5650 - val_categorical_accuracy: 0.6355
Epoch 56/100
38/38 [==============================] - 1s 18ms/step - loss: 0.3085 - categorical_accuracy: 0.8786 - val_loss: 1.6189 - val_categorical_accuracy: 0.6321
Epoch 57/100
38/38 [==============================] - 1s 15ms/step - loss: 0.2777 - categorical_accuracy: 0.8794 - val_loss: 1.6442 - val_categorical_accuracy: 0.6321
Epoch 58/100
38/38 [==============================] - 1s 15ms/step - loss: 0.2978 - categorical_accuracy: 0.8719 - val_loss: 1.6148 - val_categorical_accuracy: 0.6455
Epoch 59/100
38/38 [==============================] - 1s 15ms/step - loss: 0.3014 - categorical_accuracy: 0.8727 - val_loss: 1.5661 - val_categorical_accuracy: 0.6321
Epoch 60/100
38/38 [==============================] - 1s 17ms/step - loss: 0.3046 - categorical_accuracy: 0.8693 - val_loss: 1.6004 - val_categorical_accuracy: 0.6254
Epoch 61/100
38/38 [==============================] - 1s 17ms/step - loss: 0.3004 - categorical_accuracy: 0.8752 - val_loss: 1.5887 - val_categorical_accuracy: 0.6254
Epoch 62/100
38/38 [==============================] - 1s 16ms/step - loss: 0.2723 - categorical_accuracy: 0.8811 - val_loss: 1.6034 - val_categorical_accuracy: 0.6355
Epoch 63/100
38/38 [==============================] - 1s 15ms/step - loss: 0.2889 - categorical_accuracy: 0.8786 - val_loss: 1.6522 - val_categorical_accuracy: 0.6288
Epoch 64/100
38/38 [==============================] - 1s 15ms/step - loss: 0.3059 - categorical_accuracy: 0.8719 - val_loss: 1.6209 - val_categorical_accuracy: 0.6221
Epoch 65/100
38/38 [==============================] - 1s 15ms/step - loss: 0.2962 - categorical_accuracy: 0.8727 - val_loss: 1.5982 - val_categorical_accuracy: 0.6355
Epoch 66/100
38/38 [==============================] - 1s 14ms/step - loss: 0.2850 - categorical_accuracy: 0.8802 - val_loss: 1.6193 - val_categorical_accuracy: 0.6321
Epoch 67/100
38/38 [==============================] - 1s 15ms/step - loss: 0.2804 - categorical_accuracy: 0.8853 - val_loss: 1.6534 - val_categorical_accuracy: 0.6154
Epoch 68/100
38/38 [==============================] - 1s 14ms/step - loss: 0.2753 - categorical_accuracy: 0.8861 - val_loss: 1.7147 - val_categorical_accuracy: 0.6355
Epoch 69/100
38/38 [==============================] - 1s 15ms/step - loss: 0.2751 - categorical_accuracy: 0.8827 - val_loss: 1.7111 - val_categorical_accuracy: 0.6288
Epoch 70/100
38/38 [==============================] - 1s 16ms/step - loss: 0.2812 - categorical_accuracy: 0.8886 - val_loss: 1.6822 - val_categorical_accuracy: 0.6355
Epoch 71/100
38/38 [==============================] - 1s 16ms/step - loss: 0.2729 - categorical_accuracy: 0.8769 - val_loss: 1.7382 - val_categorical_accuracy: 0.6288
Epoch 72/100
38/38 [==============================] - 1s 15ms/step - loss: 0.2749 - categorical_accuracy: 0.8786 - val_loss: 1.8112 - val_categorical_accuracy: 0.6221
Epoch 73/100
38/38 [==============================] - 1s 15ms/step - loss: 0.2702 - categorical_accuracy: 0.8777 - val_loss: 1.7893 - val_categorical_accuracy: 0.6087
Epoch 74/100
38/38 [==============================] - 1s 16ms/step - loss: 0.2707 - categorical_accuracy: 0.8894 - val_loss: 1.7819 - val_categorical_accuracy: 0.6355
Epoch 75/100
38/38 [==============================] - 1s 15ms/step - loss: 0.2776 - categorical_accuracy: 0.8794 - val_loss: 1.7301 - val_categorical_accuracy: 0.6221
Epoch 76/100
38/38 [==============================] - 1s 16ms/step - loss: 0.2723 - categorical_accuracy: 0.8911 - val_loss: 1.7624 - val_categorical_accuracy: 0.6020
Epoch 77/100
38/38 [==============================] - 1s 16ms/step - loss: 0.2574 - categorical_accuracy: 0.8861 - val_loss: 1.8392 - val_categorical_accuracy: 0.6221
Epoch 78/100
38/38 [==============================] - 1s 15ms/step - loss: 0.2687 - categorical_accuracy: 0.8878 - val_loss: 1.8795 - val_categorical_accuracy: 0.6120
Epoch 79/100
38/38 [==============================] - 1s 18ms/step - loss: 0.2598 - categorical_accuracy: 0.8802 - val_loss: 1.9829 - val_categorical_accuracy: 0.6054
Epoch 80/100
38/38 [==============================] - 1s 15ms/step - loss: 0.2637 - categorical_accuracy: 0.8844 - val_loss: 1.9069 - val_categorical_accuracy: 0.6254
Epoch 81/100
38/38 [==============================] - 1s 17ms/step - loss: 0.2535 - categorical_accuracy: 0.8945 - val_loss: 1.9334 - val_categorical_accuracy: 0.6120
Epoch 82/100
38/38 [==============================] - 1s 16ms/step - loss: 0.2704 - categorical_accuracy: 0.8869 - val_loss: 1.9357 - val_categorical_accuracy: 0.6087
Epoch 83/100
38/38 [==============================] - 1s 15ms/step - loss: 0.2525 - categorical_accuracy: 0.8861 - val_loss: 1.9961 - val_categorical_accuracy: 0.6221
Epoch 84/100
38/38 [==============================] - 1s 14ms/step - loss: 0.2629 - categorical_accuracy: 0.8936 - val_loss: 1.9343 - val_categorical_accuracy: 0.6321
Epoch 85/100
38/38 [==============================] - 1s 17ms/step - loss: 0.2692 - categorical_accuracy: 0.8861 - val_loss: 1.8772 - val_categorical_accuracy: 0.6355
Epoch 86/100
38/38 [==============================] - 1s 15ms/step - loss: 0.2500 - categorical_accuracy: 0.8886 - val_loss: 1.9583 - val_categorical_accuracy: 0.6154
Epoch 87/100
38/38 [==============================] - 1s 18ms/step - loss: 0.2680 - categorical_accuracy: 0.8869 - val_loss: 1.9252 - val_categorical_accuracy: 0.6221
Epoch 88/100
38/38 [==============================] - 1s 15ms/step - loss: 0.2542 - categorical_accuracy: 0.8878 - val_loss: 1.9548 - val_categorical_accuracy: 0.6154
Epoch 89/100
38/38 [==============================] - 1s 16ms/step - loss: 0.2606 - categorical_accuracy: 0.8786 - val_loss: 1.9200 - val_categorical_accuracy: 0.6187
Epoch 90/100
38/38 [==============================] - 1s 16ms/step - loss: 0.2362 - categorical_accuracy: 0.8987 - val_loss: 2.0106 - val_categorical_accuracy: 0.6321
Epoch 91/100
38/38 [==============================] - 1s 16ms/step - loss: 0.2538 - categorical_accuracy: 0.8945 - val_loss: 2.0765 - val_categorical_accuracy: 0.6288
Epoch 92/100
38/38 [==============================] - 1s 15ms/step - loss: 0.2543 - categorical_accuracy: 0.8886 - val_loss: 2.0299 - val_categorical_accuracy: 0.6321
Epoch 93/100
38/38 [==============================] - 1s 15ms/step - loss: 0.2445 - categorical_accuracy: 0.8920 - val_loss: 2.0554 - val_categorical_accuracy: 0.6221
Epoch 94/100
38/38 [==============================] - 1s 15ms/step - loss: 0.2361 - categorical_accuracy: 0.8961 - val_loss: 2.1488 - val_categorical_accuracy: 0.6187
Epoch 95/100
38/38 [==============================] - 1s 14ms/step - loss: 0.2465 - categorical_accuracy: 0.8936 - val_loss: 2.0948 - val_categorical_accuracy: 0.5953
Epoch 96/100
38/38 [==============================] - 1s 18ms/step - loss: 0.2552 - categorical_accuracy: 0.8903 - val_loss: 2.1538 - val_categorical_accuracy: 0.5987
Epoch 97/100
38/38 [==============================] - 1s 17ms/step - loss: 0.2573 - categorical_accuracy: 0.8886 - val_loss: 2.1158 - val_categorical_accuracy: 0.6187
Epoch 98/100
38/38 [==============================] - 1s 16ms/step - loss: 0.2401 - categorical_accuracy: 0.8920 - val_loss: 2.0857 - val_categorical_accuracy: 0.6254
Epoch 99/100
38/38 [==============================] - 1s 15ms/step - loss: 0.2474 - categorical_accuracy: 0.8970 - val_loss: 2.1411 - val_categorical_accuracy: 0.6054
Epoch 100/100
38/38 [==============================] - 1s 16ms/step - loss: 0.2394 - categorical_accuracy: 0.8920 - val_loss: 2.2634 - val_categorical_accuracy: 0.6154
CPU times: user 1min 55s, sys: 37.1 s, total: 2min 32s
Wall time: 1min</code></pre>
</div>
</div>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>my_CNN.accuracy_plot()</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>my_CNN.loss_plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="JasmineKobayashi_NN_Exam_2023_files/figure-html/cell-30-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="JasmineKobayashi_NN_Exam_2023_files/figure-html/cell-30-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>my_CNN.test_model(verbose<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>10/10 [==============================] - 0s 8ms/step
10/10 [==============================] - 0s 9ms/step - loss: 2.2634 - categorical_accuracy: 0.6154

Model Loss from testing:
2.2634103298187256

Model Accuracy from testing:
0.6153846383094788

Preview of model prediction (raw):
[[7.7730551e-11 4.8919252e-01 5.1080751e-01]
 [9.9999237e-01 1.7660898e-07 7.5296120e-06]
 [7.5577808e-12 9.9478805e-01 5.2119363e-03]
 [4.5641782e-15 6.2511762e-04 9.9937493e-01]
 [1.0000000e+00 9.3140293e-15 8.4318382e-16]]

Preview of predictions labeled:
[['science']
 ['football']
 ['politics']
 ['science']
 ['football']]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>my_CNN.pretty_confusion_matrix()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="JasmineKobayashi_NN_Exam_2023_files/figure-html/cell-32-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="lstm" class="level1">
<h1>LSTM</h1>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>